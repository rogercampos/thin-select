const buildContainer = () => {
    const container = document.createElement('div');
    container.classList.add('ss-main');
    return container;
};
const buildContent = () => {
    const content = document.createElement('div');
    content.classList.add('ss-content');
    return content;
};
const buildSearch = (onSearch) => {
    const container = document.createElement('div');
    container.classList.add('ss-search');
    const input = document.createElement('input');
    const searchReturn = {
        container,
        input
    };
    input.type = 'search';
    input.tabIndex = 0;
    input.setAttribute('aria-label', "Search...");
    input.setAttribute('autocapitalize', 'off');
    input.setAttribute('autocomplete', 'off');
    input.setAttribute('autocorrect', 'off');
    input.addEventListener('input', () => {
        onSearch(input.value);
    });
    container.appendChild(input);
    return searchReturn;
};
const buildResultsList = () => {
    const list = document.createElement('div');
    list.classList.add('ss-list');
    list.setAttribute('role', 'listbox');
    return list;
};
const buildSingleSelect = (onClick) => {
    const container = document.createElement('div');
    container.classList.add('ss-single-selected');
    // Title text
    const title = document.createElement('span');
    title.classList.add('placeholder');
    container.appendChild(title);
    // Arrow
    const arrowContainer = document.createElement('span');
    arrowContainer.classList.add('ss-arrow');
    const arrowIcon = document.createElement('span');
    arrowIcon.classList.add('arrow-down');
    arrowContainer.appendChild(arrowIcon);
    container.appendChild(arrowContainer);
    container.onclick = onClick;
    return {
        container,
        title,
        arrowIcon: {
            container: arrowContainer,
            arrow: arrowIcon
        }
    };
};
const generateOption = (option, onOptionSelect) => {
    const optionEl = document.createElement('div');
    optionEl.classList.add('ss-option');
    optionEl.setAttribute('role', 'option');
    optionEl.addEventListener('click', () => {
        onOptionSelect(option);
    });
    if (option.selected) {
        optionEl.classList.add('ss-option-selected');
    }
    if (option.innerHtml) {
        optionEl.innerHTML = option.innerHtml;
    }
    else {
        optionEl.innerText = option.text || '\xa0';
    }
    return optionEl;
};

class View {
    container;
    content;
    search;
    list;
    singleSelected;
    onSearch;
    onClose;
    onOpen;
    onOptionSelect;
    isMultiple;
    isOpened;
    element;
    constructor(el, isMultiple, onSearch, onOptionSelect, onClose, onOpen) {
        this.element = el;
        this.onSearch = onSearch;
        this.onOptionSelect = onOptionSelect;
        this.onClose = onClose;
        this.onOpen = onOpen;
        this.isMultiple = isMultiple;
        this.isOpened = false;
        this.container = buildContainer();
        this.content = buildContent();
        this.search = buildSearch(this.onSearch);
        this.list = buildResultsList();
        const onClick = () => {
            this.isOpened ? this.onClose() : this.onOpen();
        };
        this.singleSelected = buildSingleSelect(onClick);
        this.container.appendChild(this.singleSelected.container);
        this.container.appendChild(this.content);
        this.content.appendChild(this.search.container);
        this.content.appendChild(this.list);
        el.style.display = 'none';
        if (el.parentNode) {
            el.parentNode.insertBefore(this.container, el.nextSibling);
        }
        else {
            throw new Error('thin-select: The given select element must have a parent node');
        }
    }
    openPanel = () => {
        this.isOpened = true;
        if (this.singleSelected) {
            this.singleSelected.arrowIcon.arrow.classList.remove('arrow-down');
            this.singleSelected.arrowIcon.arrow.classList.add('arrow-up');
            this.singleSelected.container.classList.add('ss-open-below');
        }
        this.content.classList.add('ss-open');
        // setTimeout is for animation completion
        setTimeout(() => {
            this.search.input.focus();
        }, 100);
    };
    closePanel = () => {
        this.isOpened = false;
        this.search.input.value = '';
        if (this.singleSelected) {
            this.singleSelected.container.classList.remove('ss-open-above');
            this.singleSelected.container.classList.remove('ss-open-below');
            this.singleSelected.arrowIcon.arrow.classList.add('arrow-down');
            this.singleSelected.arrowIcon.arrow.classList.remove('arrow-up');
        }
        this.content.classList.remove('ss-open');
    };
    setSelected = (option) => {
        if (this.singleSelected) {
            this.singleSelected.title.innerText = option.text;
        }
        Array.from(this.element.options).forEach((o) => {
            if (o.value === option.value) {
                o.selected = true;
            }
            else {
                o.selected = false;
            }
        });
    };
    setDisplayList = (options) => {
        this.list.innerHTML = '';
        options.forEach((option) => this.list.appendChild(generateOption(option, this.onOptionSelect)));
    };
    setElementOptions = (options) => {
        this.element.innerHTML = '';
        options.forEach((option) => {
            const opt = document.createElement('option');
            opt.value = option.value;
            opt.innerText = option.text;
            opt.selected = option.selected;
            this.element.appendChild(opt);
        });
    };
}

class SelectParser {
    el;
    constructor(el) {
        if (!(el instanceof HTMLSelectElement)) {
            throw new Error('thin-select: "select" dom element must be an HTMLSelectElement');
        }
        this.el = el;
    }
    analyze() {
        const isMultiple = this.el.multiple;
        const options = [];
        Array.from(this.el.options).forEach((option) => {
            options.push({ value: option.value, text: option.text, selected: option.selected });
        });
        let defaultOption;
        options.forEach(option => {
            if (option.selected) {
                defaultOption = option;
            }
        });
        defaultOption = defaultOption || options[0];
        return ({
            isMultiple,
            options,
            defaultOption
        });
    }
}

class ThinSelect {
    view;
    displayedOptionsList;
    isSearching;
    ajax;
    constructor(params) {
        const el = typeof (params.select) === "string" ? document.querySelector(params.select) : params.select;
        const initialSelectInfo = (new SelectParser(el)).analyze();
        this.isSearching = false;
        this.view = new View(el, initialSelectInfo.isMultiple, this.onSearch, this.onOptionSelect, this.closePanel, this.openPanel);
        this.displayedOptionsList = initialSelectInfo.options;
        this.view.setDisplayList(this.displayedOptionsList);
        this.view.setSelected(initialSelectInfo.defaultOption);
        this.ajax = params.ajax;
    }
    onSearch = (text) => {
        this.isSearching = true;
        if (this.ajax) {
            this.ajax(text, (data) => {
                this.displayedOptionsList = data;
                this.view.setElementOptions(data);
                this.view.setDisplayList(data);
            });
        }
        else {
            const matchedOptions = this.displayedOptionsList.filter(option => this.searchFilter(option.text, text));
            this.view.setDisplayList(matchedOptions);
        }
    };
    closePanel = () => {
        this.view.closePanel();
        setTimeout(() => {
            this.view.setDisplayList(this.displayedOptionsList);
        }, 100);
        this.isSearching = false;
    };
    openPanel = () => {
        this.view.openPanel();
    };
    onOptionSelect = (option) => {
        this.displayedOptionsList.forEach((x) => {
            if (x.value === option.value) {
                x.selected = true;
            }
            else {
                x.selected = false;
            }
        });
        this.view.setSelected(option);
        this.closePanel();
    };
    searchFilter = (optionText, inputText) => {
        return optionText.toLowerCase().indexOf(inputText.toLowerCase()) !== -1;
    };
}

export { ThinSelect as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9kb21fZmFjdG9yeS50cyIsIi4uL3NyYy92aWV3LnRzIiwiLi4vc3JjL3NlbGVjdF9wYXJzZXIudHMiLCIuLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtPcHRpb259IGZyb20gXCIuL21vZGVsc1wiXG5pbXBvcnQgeyBTZWFyY2gsIFNpbmdsZVNlbGVjdGVkIH0gZnJvbSBcIi4vdmlld1wiO1xuXG5jb25zdCBidWlsZENvbnRhaW5lciA9ICgpID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzcy1tYWluJyk7XG4gIHJldHVybiBjb250YWluZXI7XG59XG5cbmNvbnN0IGJ1aWxkQ29udGVudCA9ICgpID0+IHtcbiAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBjb250ZW50LmNsYXNzTGlzdC5hZGQoJ3NzLWNvbnRlbnQnKTtcbiAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbmNvbnN0IGJ1aWxkU2VhcmNoID0gKG9uU2VhcmNoOiAodGV4dDogc3RyaW5nKSA9PiB2b2lkKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzcy1zZWFyY2gnKTtcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gIFxuICBjb25zdCBzZWFyY2hSZXR1cm46IFNlYXJjaCA9IHtcbiAgICBjb250YWluZXIsXG4gICAgaW5wdXRcbiAgfVxuICBcbiAgaW5wdXQudHlwZSA9ICdzZWFyY2gnXG4gIGlucHV0LnRhYkluZGV4ID0gMFxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBcIlNlYXJjaC4uLlwiKVxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpXG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywgJ29mZicpXG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnYXV0b2NvcnJlY3QnLCAnb2ZmJylcbiAgXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgIG9uU2VhcmNoKGlucHV0LnZhbHVlKTtcbiAgfSlcbiAgXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dClcbiAgXG4gIHJldHVybiBzZWFyY2hSZXR1cm47XG59XG5cblxuY29uc3QgYnVpbGRSZXN1bHRzTGlzdCA9ICgpID0+IHtcbiAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIGxpc3QuY2xhc3NMaXN0LmFkZCgnc3MtbGlzdCcpXG4gIGxpc3Quc2V0QXR0cmlidXRlKCdyb2xlJywgJ2xpc3Rib3gnKVxuICByZXR1cm4gbGlzdDtcbn1cblxuXG5jb25zdCBidWlsZFNpbmdsZVNlbGVjdCA9IChvbkNsaWNrOiAoKSA9PiB2b2lkKTogU2luZ2xlU2VsZWN0ZWQgPT4ge1xuICBjb25zdCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLXNpbmdsZS1zZWxlY3RlZCcpXG4gIFxuICAvLyBUaXRsZSB0ZXh0XG4gIGNvbnN0IHRpdGxlOiBIVE1MU3BhbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgdGl0bGUuY2xhc3NMaXN0LmFkZCgncGxhY2Vob2xkZXInKVxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpXG4gIFxuICAvLyBBcnJvd1xuICBjb25zdCBhcnJvd0NvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gIGFycm93Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLWFycm93JylcbiAgXG4gIGNvbnN0IGFycm93SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICBhcnJvd0ljb24uY2xhc3NMaXN0LmFkZCgnYXJyb3ctZG93bicpXG4gIGFycm93Q29udGFpbmVyLmFwcGVuZENoaWxkKGFycm93SWNvbilcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKGFycm93Q29udGFpbmVyKVxuICBcbiAgY29udGFpbmVyLm9uY2xpY2sgPSBvbkNsaWNrO1xuICBcbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXIsXG4gICAgdGl0bGUsXG4gICAgYXJyb3dJY29uOiB7XG4gICAgICBjb250YWluZXI6IGFycm93Q29udGFpbmVyLFxuICAgICAgYXJyb3c6IGFycm93SWNvblxuICAgIH1cbiAgfVxufVxuXG5cbmNvbnN0IGdlbmVyYXRlT3B0aW9uID0gKG9wdGlvbjogT3B0aW9uLCBvbk9wdGlvblNlbGVjdDogKGE6IE9wdGlvbikgPT4gdm9pZCkgPT4ge1xuICBjb25zdCBvcHRpb25FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIG9wdGlvbkVsLmNsYXNzTGlzdC5hZGQoJ3NzLW9wdGlvbicpXG4gIG9wdGlvbkVsLnNldEF0dHJpYnV0ZSgncm9sZScsICdvcHRpb24nKVxuICBcbiAgb3B0aW9uRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgb25PcHRpb25TZWxlY3Qob3B0aW9uKTtcbiAgfSlcbiAgXG4gIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICBvcHRpb25FbC5jbGFzc0xpc3QuYWRkKCdzcy1vcHRpb24tc2VsZWN0ZWQnKTtcbiAgfVxuICBcbiAgaWYgKG9wdGlvbi5pbm5lckh0bWwpIHtcbiAgICBvcHRpb25FbC5pbm5lckhUTUwgPSBvcHRpb24uaW5uZXJIdG1sO1xuICB9IGVsc2Uge1xuICAgIG9wdGlvbkVsLmlubmVyVGV4dCA9IG9wdGlvbi50ZXh0IHx8ICdcXHhhMCc7XG4gIH1cbiAgXG4gIHJldHVybiBvcHRpb25FbDtcbn1cbiAgXG5cbmV4cG9ydCB7IGJ1aWxkQ29udGFpbmVyLCBidWlsZENvbnRlbnQsIGJ1aWxkU2VhcmNoLCBidWlsZFJlc3VsdHNMaXN0LCBidWlsZFNpbmdsZVNlbGVjdCwgZ2VuZXJhdGVPcHRpb24gfTsiLCJpbXBvcnQge09wdGlvbn0gZnJvbSBcIi4vbW9kZWxzXCI7XG5pbXBvcnQge1xuICBidWlsZENvbnRhaW5lcixcbiAgYnVpbGRDb250ZW50LFxuICBidWlsZFJlc3VsdHNMaXN0LFxuICBidWlsZFNlYXJjaCxcbiAgYnVpbGRTaW5nbGVTZWxlY3QsXG4gIGdlbmVyYXRlT3B0aW9uXG59IGZyb20gXCIuL2RvbV9mYWN0b3J5XCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2luZ2xlU2VsZWN0ZWQge1xuICBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gIHRpdGxlOiBIVE1MU3BhbkVsZW1lbnRcbiAgYXJyb3dJY29uOiB7XG4gICAgY29udGFpbmVyOiBIVE1MU3BhbkVsZW1lbnRcbiAgICBhcnJvdzogSFRNTFNwYW5FbGVtZW50XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2gge1xuICBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gIGlucHV0OiBIVE1MSW5wdXRFbGVtZW50XG4gIGFkZGFibGU/OiBIVE1MRGl2RWxlbWVudFxufVxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpZXcge1xuICBwdWJsaWMgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudFxuICBwdWJsaWMgY29udGVudDogSFRNTERpdkVsZW1lbnRcbiAgcHVibGljIHNlYXJjaDogU2VhcmNoXG4gIHB1YmxpYyBsaXN0OiBIVE1MRGl2RWxlbWVudFxuICBwdWJsaWMgc2luZ2xlU2VsZWN0ZWQ6IFNpbmdsZVNlbGVjdGVkIHwgbnVsbFxuICBcbiAgcHVibGljIG9uU2VhcmNoOiBhbnlcbiAgcHVibGljIG9uQ2xvc2U6IGFueVxuICBwdWJsaWMgb25PcGVuOiBhbnlcbiAgcHVibGljIG9uT3B0aW9uU2VsZWN0OiBhbnlcbiAgcHVibGljIGlzTXVsdGlwbGU6IGJvb2xlYW5cbiAgcHVibGljIGlzT3BlbmVkOiBib29sZWFuXG4gIFxuICBwdWJsaWMgZWxlbWVudDogSFRNTFNlbGVjdEVsZW1lbnQ7XG4gIFxuICBjb25zdHJ1Y3RvcihcbiAgICAgIGVsOiBIVE1MU2VsZWN0RWxlbWVudCxcbiAgICAgIGlzTXVsdGlwbGU6IGJvb2xlYW4sXG4gICAgICBvblNlYXJjaDogYW55LFxuICAgICAgb25PcHRpb25TZWxlY3Q6IGFueSxcbiAgICAgIG9uQ2xvc2U6IGFueSxcbiAgICAgIG9uT3BlbjogYW55LFxuICApIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbDtcbiAgICB0aGlzLm9uU2VhcmNoID0gb25TZWFyY2g7XG4gICAgdGhpcy5vbk9wdGlvblNlbGVjdCA9IG9uT3B0aW9uU2VsZWN0O1xuICAgIHRoaXMub25DbG9zZSA9IG9uQ2xvc2U7XG4gICAgdGhpcy5vbk9wZW4gPSBvbk9wZW47XG4gICAgXG4gICAgdGhpcy5pc011bHRpcGxlID0gaXNNdWx0aXBsZTtcbiAgICB0aGlzLmlzT3BlbmVkID0gZmFsc2U7XG4gICAgXG4gICAgdGhpcy5jb250YWluZXIgPSBidWlsZENvbnRhaW5lcigpO1xuICAgIFxuICAgIHRoaXMuY29udGVudCA9IGJ1aWxkQ29udGVudCgpO1xuICAgIHRoaXMuc2VhcmNoID0gYnVpbGRTZWFyY2godGhpcy5vblNlYXJjaCk7XG4gICAgdGhpcy5saXN0ID0gYnVpbGRSZXN1bHRzTGlzdCgpO1xuICAgIFxuICAgIGNvbnN0IG9uQ2xpY2sgPSAoKTogdm9pZCA9PiB7XG4gICAgICB0aGlzLmlzT3BlbmVkID8gdGhpcy5vbkNsb3NlKCkgOiB0aGlzLm9uT3BlbigpO1xuICAgIH1cbiAgICB0aGlzLnNpbmdsZVNlbGVjdGVkID0gYnVpbGRTaW5nbGVTZWxlY3Qob25DbGljayk7XG4gICAgXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zaW5nbGVTZWxlY3RlZC5jb250YWluZXIpXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50KVxuICAgIFxuICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLnNlYXJjaC5jb250YWluZXIpXG4gICAgdGhpcy5jb250ZW50LmFwcGVuZENoaWxkKHRoaXMubGlzdClcbiAgICBcbiAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIFxuICAgIGlmIChlbC5wYXJlbnROb2RlKSB7XG4gICAgICBlbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmNvbnRhaW5lciwgZWwubmV4dFNpYmxpbmcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigndGhpbi1zZWxlY3Q6IFRoZSBnaXZlbiBzZWxlY3QgZWxlbWVudCBtdXN0IGhhdmUgYSBwYXJlbnQgbm9kZScpO1xuICAgIH1cbiAgfVxuICBcbiAgb3BlblBhbmVsID0gKCk6IHZvaWQgPT4ge1xuICAgIHRoaXMuaXNPcGVuZWQgPSB0cnVlO1xuICAgIFxuICAgIGlmICh0aGlzLnNpbmdsZVNlbGVjdGVkKSB7XG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLmFycm93SWNvbi5hcnJvdy5jbGFzc0xpc3QucmVtb3ZlKCdhcnJvdy1kb3duJylcbiAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQuYXJyb3dJY29uLmFycm93LmNsYXNzTGlzdC5hZGQoJ2Fycm93LXVwJylcbiAgICAgIFxuICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZC5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgnc3Mtb3Blbi1iZWxvdycpXG4gICAgfVxuICAgIFxuICAgIHRoaXMuY29udGVudC5jbGFzc0xpc3QuYWRkKCdzcy1vcGVuJylcbiAgICBcbiAgICAvLyBzZXRUaW1lb3V0IGlzIGZvciBhbmltYXRpb24gY29tcGxldGlvblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5zZWFyY2guaW5wdXQuZm9jdXMoKVxuICAgIH0sIDEwMClcbiAgfVxuICBcbiAgY2xvc2VQYW5lbCA9ICgpOiB2b2lkID0+IHtcbiAgICB0aGlzLmlzT3BlbmVkID0gZmFsc2U7XG4gICAgdGhpcy5zZWFyY2guaW5wdXQudmFsdWUgPSAnJztcbiAgICBcbiAgICBpZiAodGhpcy5zaW5nbGVTZWxlY3RlZCkge1xuICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZC5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnc3Mtb3Blbi1hYm92ZScpXG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdzcy1vcGVuLWJlbG93JylcbiAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQuYXJyb3dJY29uLmFycm93LmNsYXNzTGlzdC5hZGQoJ2Fycm93LWRvd24nKVxuICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZC5hcnJvd0ljb24uYXJyb3cuY2xhc3NMaXN0LnJlbW92ZSgnYXJyb3ctdXAnKVxuICAgIH1cbiAgICBcbiAgICB0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgnc3Mtb3BlbicpXG4gIH1cbiAgXG4gIFxuICBzZXRTZWxlY3RlZCA9IChvcHRpb246IE9wdGlvbik6IHZvaWQgPT4ge1xuICAgIGlmICh0aGlzLnNpbmdsZVNlbGVjdGVkKSB7XG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLnRpdGxlLmlubmVyVGV4dCA9IG9wdGlvbi50ZXh0O1xuICAgIH1cbiAgICBcbiAgICBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5vcHRpb25zKS5mb3JFYWNoKChvKSA9PiB7XG4gICAgICBpZiAoby52YWx1ZSA9PT0gb3B0aW9uLnZhbHVlKSB7XG4gICAgICAgIG8uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbiAgXG4gIHNldERpc3BsYXlMaXN0ID0gKG9wdGlvbnM6IE9wdGlvbltdKTogdm9pZCA9PiB7XG4gICAgdGhpcy5saXN0LmlubmVySFRNTCA9ICcnO1xuICAgIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB0aGlzLmxpc3QuYXBwZW5kQ2hpbGQoZ2VuZXJhdGVPcHRpb24ob3B0aW9uLCB0aGlzLm9uT3B0aW9uU2VsZWN0KSkpXG4gIH07XG4gIFxuICBzZXRFbGVtZW50T3B0aW9ucyA9IChvcHRpb25zOiBPcHRpb25bXSk6IHZvaWQgPT4ge1xuICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgXG4gICAgb3B0aW9ucy5mb3JFYWNoKChvcHRpb24pID0+IHtcbiAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgb3B0LnZhbHVlID0gb3B0aW9uLnZhbHVlO1xuICAgICAgb3B0LmlubmVyVGV4dCA9IG9wdGlvbi50ZXh0O1xuICAgICAgb3B0LnNlbGVjdGVkID0gb3B0aW9uLnNlbGVjdGVkO1xuICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKG9wdCk7XG4gICAgfSlcbiAgfVxuICBcbn0iLCJpbXBvcnQgeyBPcHRpb259IGZyb20gXCIuL21vZGVsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RQYXJzZXIge1xuICBwdWJsaWMgZWw6IEhUTUxTZWxlY3RFbGVtZW50O1xuICBcbiAgY29uc3RydWN0b3IoZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgaWYgKCEoZWwgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigndGhpbi1zZWxlY3Q6IFwic2VsZWN0XCIgZG9tIGVsZW1lbnQgbXVzdCBiZSBhbiBIVE1MU2VsZWN0RWxlbWVudCcpO1xuICAgIH1cbiAgICB0aGlzLmVsID0gZWw7XG4gIH1cbiAgXG4gIGFuYWx5emUoKSB7XG4gICAgY29uc3QgaXNNdWx0aXBsZSA9IHRoaXMuZWwubXVsdGlwbGU7XG4gICAgY29uc3Qgb3B0aW9uczogT3B0aW9uW10gPSBbXTtcbiAgXG4gICAgQXJyYXkuZnJvbSh0aGlzLmVsLm9wdGlvbnMpLmZvckVhY2goKG9wdGlvbjogSFRNTE9wdGlvbkVsZW1lbnQpID0+IHtcbiAgICAgIG9wdGlvbnMucHVzaCh7IHZhbHVlOiBvcHRpb24udmFsdWUsIHRleHQ6IG9wdGlvbi50ZXh0LCBzZWxlY3RlZDogb3B0aW9uLnNlbGVjdGVkIH0pO1xuICAgIH0pO1xuICBcbiAgICBsZXQgZGVmYXVsdE9wdGlvbjtcbiAgICBvcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgZGVmYXVsdE9wdGlvbiA9IG9wdGlvbjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBkZWZhdWx0T3B0aW9uID0gZGVmYXVsdE9wdGlvbiB8fCBvcHRpb25zWzBdO1xuICAgIFxuICAgIHJldHVybih7XG4gICAgICBpc011bHRpcGxlLFxuICAgICAgb3B0aW9ucyxcbiAgICAgIGRlZmF1bHRPcHRpb25cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi4vc3R5bGVzL3RoaW4tc2VsZWN0LnNjc3NcIlxuaW1wb3J0IFZpZXcgZnJvbSBcIi4vdmlld1wiO1xuaW1wb3J0IFNlbGVjdFBhcnNlciBmcm9tIFwiLi9zZWxlY3RfcGFyc2VyXCI7XG5pbXBvcnQge09wdGlvbn0gZnJvbSBcIi4vbW9kZWxzXCJcblxuaW50ZXJmYWNlIFRoaW5TZWxlY3RQYXJhbXMge1xuICBzZWxlY3Q6IHN0cmluZyB8IEhUTUxTZWxlY3RFbGVtZW50O1xuICBhamF4PzogKGlucHV0VGV4dDogc3RyaW5nLCBjYWxsYmFjazogKGRhdGE6IE9wdGlvbltdKSA9PiB2b2lkKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaGluU2VsZWN0IHtcbiAgcHVibGljIHZpZXc6IFZpZXc7XG4gIHB1YmxpYyBkaXNwbGF5ZWRPcHRpb25zTGlzdDogT3B0aW9uW107XG4gIHB1YmxpYyBpc1NlYXJjaGluZzogYm9vbGVhbjtcbiAgcHVibGljIGFqYXg6ICgoaW5wdXRUZXh0OiBzdHJpbmcsIGNhbGxiYWNrOiAoZGF0YTogT3B0aW9uW10pID0+IHZvaWQpID0+IHZvaWQpIHwgdW5kZWZpbmVkO1xuICBcbiAgY29uc3RydWN0b3IocGFyYW1zOiBUaGluU2VsZWN0UGFyYW1zKSB7XG4gICAgY29uc3QgZWw6IEhUTUxTZWxlY3RFbGVtZW50ID0gdHlwZW9mIChwYXJhbXMuc2VsZWN0KSA9PT0gXCJzdHJpbmdcIiA/IChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhcmFtcy5zZWxlY3QpIGFzIEhUTUxTZWxlY3RFbGVtZW50KSA6IHBhcmFtcy5zZWxlY3Q7XG4gICAgXG4gICAgY29uc3QgaW5pdGlhbFNlbGVjdEluZm8gPSAobmV3IFNlbGVjdFBhcnNlcihlbCkpLmFuYWx5emUoKTtcbiAgICBcbiAgICB0aGlzLmlzU2VhcmNoaW5nID0gZmFsc2U7XG4gICAgXG4gICAgdGhpcy52aWV3ID0gbmV3IFZpZXcoXG4gICAgICAgIGVsLFxuICAgICAgICBpbml0aWFsU2VsZWN0SW5mby5pc011bHRpcGxlLFxuICAgICAgICB0aGlzLm9uU2VhcmNoLFxuICAgICAgICB0aGlzLm9uT3B0aW9uU2VsZWN0LFxuICAgICAgICB0aGlzLmNsb3NlUGFuZWwsXG4gICAgICAgIHRoaXMub3BlblBhbmVsLFxuICAgICk7XG4gICAgdGhpcy5kaXNwbGF5ZWRPcHRpb25zTGlzdCA9IGluaXRpYWxTZWxlY3RJbmZvLm9wdGlvbnM7XG4gICAgdGhpcy52aWV3LnNldERpc3BsYXlMaXN0KHRoaXMuZGlzcGxheWVkT3B0aW9uc0xpc3QpO1xuICAgIHRoaXMudmlldy5zZXRTZWxlY3RlZChpbml0aWFsU2VsZWN0SW5mby5kZWZhdWx0T3B0aW9uKTtcbiAgICBcbiAgICB0aGlzLmFqYXggPSBwYXJhbXMuYWpheDtcbiAgfVxuICBcbiAgb25TZWFyY2ggPSAodGV4dDogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgdGhpcy5pc1NlYXJjaGluZyA9IHRydWU7XG4gICAgXG4gICAgaWYgKHRoaXMuYWpheCkge1xuICAgICAgdGhpcy5hamF4KHRleHQsIChkYXRhOiBPcHRpb25bXSkgPT4ge1xuICAgICAgICB0aGlzLmRpc3BsYXllZE9wdGlvbnNMaXN0ID0gZGF0YTtcbiAgICAgICAgdGhpcy52aWV3LnNldEVsZW1lbnRPcHRpb25zKGRhdGEpO1xuICAgICAgICB0aGlzLnZpZXcuc2V0RGlzcGxheUxpc3QoZGF0YSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbWF0Y2hlZE9wdGlvbnMgPSB0aGlzLmRpc3BsYXllZE9wdGlvbnNMaXN0LmZpbHRlcihvcHRpb24gPT4gdGhpcy5zZWFyY2hGaWx0ZXIob3B0aW9uLnRleHQsIHRleHQpKTtcbiAgICAgIHRoaXMudmlldy5zZXREaXNwbGF5TGlzdChtYXRjaGVkT3B0aW9ucyk7XG4gICAgfVxuICB9XG4gIFxuICBjbG9zZVBhbmVsID0gKCk6IHZvaWQgPT4ge1xuICAgIHRoaXMudmlldy5jbG9zZVBhbmVsKCk7XG4gICAgXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnZpZXcuc2V0RGlzcGxheUxpc3QodGhpcy5kaXNwbGF5ZWRPcHRpb25zTGlzdCk7XG4gICAgfSwgMTAwKTtcbiAgICB0aGlzLmlzU2VhcmNoaW5nID0gZmFsc2U7XG4gIH1cbiAgXG4gIG9wZW5QYW5lbCA9ICgpOiB2b2lkID0+IHtcbiAgICB0aGlzLnZpZXcub3BlblBhbmVsKCk7XG4gIH1cbiAgXG4gIG9uT3B0aW9uU2VsZWN0ID0gKG9wdGlvbjogT3B0aW9uKTogdm9pZCA9PiB7XG4gICAgdGhpcy5kaXNwbGF5ZWRPcHRpb25zTGlzdC5mb3JFYWNoKCh4KSA9PiB7XG4gICAgICBpZiAoeC52YWx1ZSA9PT0gb3B0aW9uLnZhbHVlKSB7XG4gICAgICAgIHguc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgeC5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pXG4gICAgdGhpcy52aWV3LnNldFNlbGVjdGVkKG9wdGlvbik7XG4gICAgdGhpcy5jbG9zZVBhbmVsKCk7XG4gIH1cbiAgXG4gIHNlYXJjaEZpbHRlciA9IChvcHRpb25UZXh0OiBzdHJpbmcsIGlucHV0VGV4dDogc3RyaW5nKSA6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiBvcHRpb25UZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihpbnB1dFRleHQudG9Mb3dlckNhc2UoKSkgIT09IC0xO1xuICB9XG4gIFxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE1BQU0sY0FBYyxHQUFHLE1BQUs7SUFDMUIsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNoRCxJQUFBLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ25DLElBQUEsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQyxDQUFBO0FBRUQsTUFBTSxZQUFZLEdBQUcsTUFBSztJQUN4QixNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzlDLElBQUEsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDcEMsSUFBQSxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDLENBQUE7QUFFRCxNQUFNLFdBQVcsR0FBRyxDQUFDLFFBQWdDLEtBQUk7SUFDdkQsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUMvQyxJQUFBLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUE7QUFFN0MsSUFBQSxNQUFNLFlBQVksR0FBVztRQUMzQixTQUFTO1FBQ1QsS0FB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
