class DomBuilder {
    container;
    content;
    search;
    list;
    singleSelected;
    onSearch;
    onDeselect;
    onClose;
    onOpen;
    onOptionSelect;
    isMultiple;
    isOpened;
    element;
    constructor(el, id, isMultiple, onSearch, onOptionSelect, onDeselect, onClose, onOpen) {
        this.element = el;
        this.onSearch = onSearch;
        this.onDeselect = onDeselect;
        this.onOptionSelect = onOptionSelect;
        this.onClose = onClose;
        this.onOpen = onOpen;
        this.isMultiple = isMultiple;
        this.isOpened = false;
        this.container = document.createElement('div');
        this.container.id = id;
        this.container.classList.add('ss-main');
        this.content = document.createElement('div');
        this.content.classList.add('ss-content');
        this.search = this.#searchDiv();
        this.list = this.#listDiv();
        this.singleSelected = this.singleSelectedDiv();
        this.container.appendChild(this.singleSelected.container);
        this.container.appendChild(this.content);
        this.content.appendChild(this.search.container);
        this.content.appendChild(this.list);
        el.style.display = 'none';
        el.dataset.tsid = id;
        if (el.parentNode) {
            el.parentNode.insertBefore(this.container, el.nextSibling);
        }
        else {
            throw new Error('thin-select: The given select element must have a parent node');
        }
    }
    openPanel = () => {
        this.isOpened = true;
        if (this.singleSelected) {
            this.singleSelected.arrowIcon.arrow.classList.remove('arrow-down');
            this.singleSelected.arrowIcon.arrow.classList.add('arrow-up');
            this.singleSelected.container.classList.add('ss-open-below');
        }
        this.content.classList.add('ss-open');
        // setTimeout is for animation completion
        setTimeout(() => {
            this.search.input.focus();
        }, 100);
    };
    closePanel = () => {
        this.isOpened = false;
        this.search.input.value = '';
        if (this.singleSelected) {
            this.singleSelected.container.classList.remove('ss-open-above');
            this.singleSelected.container.classList.remove('ss-open-below');
            this.singleSelected.arrowIcon.arrow.classList.add('arrow-down');
            this.singleSelected.arrowIcon.arrow.classList.remove('arrow-up');
        }
        this.content.classList.remove('ss-open');
    };
    setDisplayList = (options) => {
        // Clear out innerHtml
        this.list.innerHTML = '';
        for (const d of options) {
            this.list.appendChild(this.#generateOption(d));
        }
    };
    #generateOption = (option) => {
        const optionEl = document.createElement('div');
        optionEl.classList.add('ss-option');
        optionEl.setAttribute('role', 'option');
        optionEl.addEventListener('click', (e) => {
            this.onOptionSelect(option);
        });
        if (option.selected) {
            optionEl.classList.add('ss-option-selected');
        }
        if (option.innerHtml) {
            optionEl.innerHTML = option.innerHtml;
        }
        else {
            optionEl.innerText = option.text || '\xa0';
        }
        return optionEl;
    };
    setSelected = (option) => {
        if (this.singleSelected) {
            this.singleSelected.placeholder.innerText = option.text;
        }
        Array.from(this.element.options).forEach((o) => {
            if (o.value === option.value) {
                o.selected = true;
            }
            else {
                o.selected = false;
            }
        });
    };
    #searchDiv() {
        const container = document.createElement('div');
        container.classList.add('ss-search');
        const input = document.createElement('input');
        document.createElement('div');
        // Setup search return object
        const searchReturn = {
            container,
            input
        };
        input.type = 'search';
        input.placeholder = "Search...";
        input.tabIndex = 0;
        input.setAttribute('aria-label', input.placeholder);
        input.setAttribute('autocapitalize', 'off');
        input.setAttribute('autocomplete', 'off');
        input.setAttribute('autocorrect', 'off');
        input.addEventListener('input', (e) => {
            this.onSearch(e.target.value);
        });
        container.appendChild(input);
        // addable.innerHTML = '+'
        // addable.onclick = (e) => {
        //   e.preventDefault()
        //   e.stopPropagation()
        //
        //   const inputValue = this.search.input.value
        //   if (inputValue.trim() === '') {
        //     this.search.input.focus();
        //     return
        //   }
        //
        //   const addableValue = this.main.addable(inputValue)
        //   let addableValueStr = ''
        //   if (!addableValue) {
        //     return
        //   }
        //
        //   if (typeof addableValue === 'object') {
        //     const validValue = validateOption(addableValue)
        //     if (validValue) {
        //       this.main.addData(addableValue)
        //       addableValueStr = (addableValue.value ? addableValue.value : addableValue.text)
        //     }
        //   } else {
        //     this.main.addData(this.main.data.newOption({
        //       text: addableValue,
        //       value: addableValue
        //     }))
        //     addableValueStr = addableValue
        //   }
        //
        //   this.main.search('')
        //   setTimeout(() => { // Temp fix to solve multi render issue
        //     this.main.set(addableValueStr, 'value', false, false)
        //   }, 100)
        //
        //   // Close it only if closeOnSelect = true
        //   if (this.main.config.closeOnSelect) {
        //     setTimeout(() => { // Give it a little padding for a better looking animation
        //       this.main.close()
        //     }, 100)
        //   }
        // }
        // container.appendChild(addable)
        //
        // searchReturn.addable = addable
        return searchReturn;
    }
    #listDiv() {
        const list = document.createElement('div');
        list.classList.add('ss-list');
        list.setAttribute('role', 'listbox');
        return list;
    }
    singleSelectedDiv() {
        const container = document.createElement('div');
        container.classList.add('ss-single-selected');
        // Placeholder text
        const placeholder = document.createElement('span');
        placeholder.classList.add('placeholder');
        container.appendChild(placeholder);
        // Deselect
        const deselect = document.createElement('span');
        deselect.innerHTML = "x";
        deselect.classList.add('ss-deselect', 'ss-hide');
        deselect.onclick = this.onDeselect;
        container.appendChild(deselect);
        // Arrow
        const arrowContainer = document.createElement('span');
        arrowContainer.classList.add('ss-arrow');
        const arrowIcon = document.createElement('span');
        arrowIcon.classList.add('arrow-down');
        arrowContainer.appendChild(arrowIcon);
        container.appendChild(arrowContainer);
        // Add onclick for main selector div
        container.onclick = () => {
            this.isOpened ? this.onClose() : this.onOpen();
        };
        return {
            container,
            placeholder,
            deselect,
            arrowIcon: {
                container: arrowContainer,
                arrow: arrowIcon
            }
        };
    }
}

class SelectParser {
    el;
    constructor(el) {
        if (!(el instanceof HTMLSelectElement)) {
            throw new Error('thin-select: "select" dom element must be an HTMLSelectElement');
        }
        this.el = el;
    }
    analyze() {
        const isMultiple = this.el.multiple;
        const options = [];
        Array.from(this.el.options).forEach((option) => {
            options.push({ value: option.value, text: option.text, selected: option.selected });
        });
        return ({
            isMultiple,
            options
        });
    }
}

class ThinSelect {
    builder;
    id;
    displayedOptionsList;
    isSearching;
    constructor(params) {
        const el = typeof (params.select) === "string" ? document.querySelector(params.select) : params.select;
        const initialSelectInfo = (new SelectParser(el)).analyze();
        this.id = 'ts-' + Math.floor(Math.random() * 100000);
        this.isSearching = false;
        this.builder = new DomBuilder(el, this.id, initialSelectInfo.isMultiple, this.onSearch, this.onOptionSelect, this.onDeselect, this.closePanel, this.openPanel);
        this.displayedOptionsList = initialSelectInfo.options;
        this.builder.setDisplayList(this.displayedOptionsList);
    }
    onSearch = (text) => {
        this.isSearching = true;
        const matchedOptions = this.displayedOptionsList.filter(option => this.searchFilter(option.text, text));
        this.builder.setDisplayList(matchedOptions);
    };
    onDeselect = () => {
        console.log(`onDeselect`);
    };
    closePanel = () => {
        this.builder.closePanel();
        setTimeout(() => {
            this.builder.setDisplayList(this.displayedOptionsList);
        }, 100);
        this.isSearching = false;
    };
    openPanel = () => {
        this.builder.openPanel();
    };
    onOptionSelect = (option) => {
        this.displayedOptionsList.forEach((x) => {
            if (x.value === option.value) {
                x.selected = true;
            }
            else {
                x.selected = false;
            }
        });
        this.builder.setSelected(option);
        this.closePanel();
    };
    searchFilter = (optionText, inputText) => {
        return optionText.toLowerCase().indexOf(inputText.toLowerCase()) !== -1;
    };
}

export { ThinSelect as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9kb21fYnVpbGRlci50cyIsIi4uL3NyYy9zZWxlY3RfcGFyc2VyLnRzIiwiLi4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7T3B0aW9ufSBmcm9tIFwiLi9tb2RlbHNcIlxuXG5pbnRlcmZhY2UgU2luZ2xlU2VsZWN0ZWQge1xuICBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50XG4gIHBsYWNlaG9sZGVyOiBIVE1MU3BhbkVsZW1lbnRcbiAgZGVzZWxlY3Q6IEhUTUxTcGFuRWxlbWVudFxuICBhcnJvd0ljb246IHtcbiAgICBjb250YWluZXI6IEhUTUxTcGFuRWxlbWVudFxuICAgIGFycm93OiBIVE1MU3BhbkVsZW1lbnRcbiAgfVxufVxuXG5pbnRlcmZhY2UgU2VhcmNoIHtcbiAgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudFxuICBpbnB1dDogSFRNTElucHV0RWxlbWVudFxuICBhZGRhYmxlPzogSFRNTERpdkVsZW1lbnRcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb21CdWlsZGVyIHtcbiAgcHVibGljIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnRcbiAgcHVibGljIGNvbnRlbnQ6IEhUTUxEaXZFbGVtZW50XG4gIHB1YmxpYyBzZWFyY2g6IFNlYXJjaFxuICBwdWJsaWMgbGlzdDogSFRNTERpdkVsZW1lbnRcbiAgcHVibGljIHNpbmdsZVNlbGVjdGVkOiBTaW5nbGVTZWxlY3RlZCB8IG51bGxcbiAgXG4gIFxuICBwdWJsaWMgb25TZWFyY2g6IGFueVxuICBwdWJsaWMgb25EZXNlbGVjdDogYW55XG4gIHB1YmxpYyBvbkNsb3NlOiBhbnlcbiAgcHVibGljIG9uT3BlbjogYW55XG4gIHB1YmxpYyBvbk9wdGlvblNlbGVjdDogYW55XG4gIHB1YmxpYyBpc011bHRpcGxlOiBib29sZWFuXG4gIHB1YmxpYyBpc09wZW5lZDogYm9vbGVhblxuICBcbiAgcHVibGljIGVsZW1lbnQ6IEhUTUxTZWxlY3RFbGVtZW50O1xuICBcbiAgY29uc3RydWN0b3IoXG4gICAgICBlbDogSFRNTFNlbGVjdEVsZW1lbnQsXG4gICAgICBpZDogc3RyaW5nLFxuICAgICAgaXNNdWx0aXBsZTogYm9vbGVhbixcbiAgICAgIG9uU2VhcmNoOiBhbnksXG4gICAgICBvbk9wdGlvblNlbGVjdDogYW55LFxuICAgICAgb25EZXNlbGVjdDogYW55LFxuICAgICAgb25DbG9zZTogYW55LFxuICAgICAgb25PcGVuOiBhbnksXG4gICkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsO1xuICAgIHRoaXMub25TZWFyY2ggPSBvblNlYXJjaDtcbiAgICB0aGlzLm9uRGVzZWxlY3QgPSBvbkRlc2VsZWN0O1xuICAgIHRoaXMub25PcHRpb25TZWxlY3QgPSBvbk9wdGlvblNlbGVjdDtcbiAgICB0aGlzLm9uQ2xvc2UgPSBvbkNsb3NlO1xuICAgIHRoaXMub25PcGVuID0gb25PcGVuO1xuICAgIFxuICAgIHRoaXMuaXNNdWx0aXBsZSA9IGlzTXVsdGlwbGU7XG4gICAgdGhpcy5pc09wZW5lZCA9IGZhbHNlO1xuICAgIFxuICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5jb250YWluZXIuaWQgPSBpZDtcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzcy1tYWluJyk7XG4gICAgXG4gICAgdGhpcy5jb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5jb250ZW50LmNsYXNzTGlzdC5hZGQoJ3NzLWNvbnRlbnQnKTtcbiAgICB0aGlzLnNlYXJjaCA9IHRoaXMuI3NlYXJjaERpdigpXG4gICAgdGhpcy5saXN0ID0gdGhpcy4jbGlzdERpdigpXG4gIFxuICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQgPSB0aGlzLnNpbmdsZVNlbGVjdGVkRGl2KClcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnNpbmdsZVNlbGVjdGVkLmNvbnRhaW5lcilcbiAgXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50KVxuICBcbiAgICB0aGlzLmNvbnRlbnQuYXBwZW5kQ2hpbGQodGhpcy5zZWFyY2guY29udGFpbmVyKVxuICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLmxpc3QpXG4gIFxuICAgIGVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgZWwuZGF0YXNldC50c2lkID0gaWQ7XG4gIFxuICAgIGlmIChlbC5wYXJlbnROb2RlKSB7XG4gICAgICBlbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmNvbnRhaW5lciwgZWwubmV4dFNpYmxpbmcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigndGhpbi1zZWxlY3Q6IFRoZSBnaXZlbiBzZWxlY3QgZWxlbWVudCBtdXN0IGhhdmUgYSBwYXJlbnQgbm9kZScpO1xuICAgIH1cbiAgfVxuICBcbiAgb3BlblBhbmVsID0gKCkgPT4ge1xuICAgIHRoaXMuaXNPcGVuZWQgPSB0cnVlO1xuICBcbiAgICBpZiAodGhpcy5zaW5nbGVTZWxlY3RlZCkge1xuICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZC5hcnJvd0ljb24uYXJyb3cuY2xhc3NMaXN0LnJlbW92ZSgnYXJyb3ctZG93bicpXG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLmFycm93SWNvbi5hcnJvdy5jbGFzc0xpc3QuYWRkKCdhcnJvdy11cCcpXG5cbiAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLW9wZW4tYmVsb3cnKVxuICAgIH1cbiAgXG4gICAgdGhpcy5jb250ZW50LmNsYXNzTGlzdC5hZGQoJ3NzLW9wZW4nKVxuICBcbiAgICAvLyBzZXRUaW1lb3V0IGlzIGZvciBhbmltYXRpb24gY29tcGxldGlvblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5zZWFyY2guaW5wdXQuZm9jdXMoKVxuICAgIH0sIDEwMClcbiAgfVxuICBcbiAgY2xvc2VQYW5lbCA9ICgpID0+IHtcbiAgICB0aGlzLmlzT3BlbmVkID0gZmFsc2U7XG4gICAgdGhpcy5zZWFyY2guaW5wdXQudmFsdWUgPSAnJztcbiAgXG4gICAgaWYgKHRoaXMuc2luZ2xlU2VsZWN0ZWQpIHtcbiAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ3NzLW9wZW4tYWJvdmUnKVxuICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZC5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnc3Mtb3Blbi1iZWxvdycpXG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLmFycm93SWNvbi5hcnJvdy5jbGFzc0xpc3QuYWRkKCdhcnJvdy1kb3duJylcbiAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWQuYXJyb3dJY29uLmFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ2Fycm93LXVwJylcbiAgICB9XG4gIFxuICAgIHRoaXMuY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCdzcy1vcGVuJylcbiAgfVxuICBcbiAgc2V0RGlzcGxheUxpc3QgPSAob3B0aW9uczogT3B0aW9uW10pID0+IHtcbiAgICAvLyBDbGVhciBvdXQgaW5uZXJIdG1sXG4gICAgdGhpcy5saXN0LmlubmVySFRNTCA9ICcnO1xuICBcbiAgICBmb3IgKGNvbnN0IGQgb2Ygb3B0aW9ucykge1xuICAgICAgdGhpcy5saXN0LmFwcGVuZENoaWxkKHRoaXMuI2dlbmVyYXRlT3B0aW9uKGQpKVxuICAgIH1cbiAgfVxuICBcbiAgI2dlbmVyYXRlT3B0aW9uID0gKG9wdGlvbjogT3B0aW9uKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIG9wdGlvbkVsLmNsYXNzTGlzdC5hZGQoJ3NzLW9wdGlvbicpXG4gICAgb3B0aW9uRWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ29wdGlvbicpXG4gICAgXG4gIFxuICAgIG9wdGlvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIHRoaXMub25PcHRpb25TZWxlY3Qob3B0aW9uKTtcbiAgICB9KVxuICAgIFxuICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgIG9wdGlvbkVsLmNsYXNzTGlzdC5hZGQoJ3NzLW9wdGlvbi1zZWxlY3RlZCcpO1xuICAgIH1cbiAgICBcbiAgICBpZiAob3B0aW9uLmlubmVySHRtbCkge1xuICAgICAgb3B0aW9uRWwuaW5uZXJIVE1MID0gb3B0aW9uLmlubmVySHRtbDtcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0aW9uRWwuaW5uZXJUZXh0ID0gb3B0aW9uLnRleHQgfHwgJ1xceGEwJztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG9wdGlvbkVsO1xuICB9XG4gIFxuICBzZXRTZWxlY3RlZCA9IChvcHRpb246IE9wdGlvbikgPT4ge1xuICAgIGlmICh0aGlzLnNpbmdsZVNlbGVjdGVkKSB7XG4gICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkLnBsYWNlaG9sZGVyLmlubmVyVGV4dCA9IG9wdGlvbi50ZXh0O1xuICAgIH1cbiAgXG4gICAgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQub3B0aW9ucykuZm9yRWFjaCgobykgPT4ge1xuICAgICAgaWYgKG8udmFsdWUgPT09IG9wdGlvbi52YWx1ZSkge1xuICAgICAgICBvLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG8uc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIFxuICBcbiAgI3NlYXJjaERpdigpOiBTZWFyY2gge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLXNlYXJjaCcpO1xuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgIGNvbnN0IGFkZGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIFxuICAgIC8vIFNldHVwIHNlYXJjaCByZXR1cm4gb2JqZWN0XG4gICAgY29uc3Qgc2VhcmNoUmV0dXJuOiBTZWFyY2ggPSB7XG4gICAgICBjb250YWluZXIsXG4gICAgICBpbnB1dFxuICAgIH1cbiAgICBcbiAgICBpbnB1dC50eXBlID0gJ3NlYXJjaCdcbiAgICBpbnB1dC5wbGFjZWhvbGRlciA9IFwiU2VhcmNoLi4uXCJcbiAgICBpbnB1dC50YWJJbmRleCA9IDBcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBpbnB1dC5wbGFjZWhvbGRlcilcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2F1dG9jYXBpdGFsaXplJywgJ29mZicpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnLCAnb2ZmJylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb3JyZWN0JywgJ29mZicpXG4gICAgXG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4ge1xuICAgICAgdGhpcy5vblNlYXJjaChlLnRhcmdldC52YWx1ZSk7XG4gICAgfSlcbiAgICBcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXQpXG4gICAgXG4gICAgLy8gYWRkYWJsZS5pbm5lckhUTUwgPSAnKydcbiAgICAvLyBhZGRhYmxlLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgIC8vICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgLy8gICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgLy9cbiAgICAvLyAgIGNvbnN0IGlucHV0VmFsdWUgPSB0aGlzLnNlYXJjaC5pbnB1dC52YWx1ZVxuICAgIC8vICAgaWYgKGlucHV0VmFsdWUudHJpbSgpID09PSAnJykge1xuICAgIC8vICAgICB0aGlzLnNlYXJjaC5pbnB1dC5mb2N1cygpO1xuICAgIC8vICAgICByZXR1cm5cbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgY29uc3QgYWRkYWJsZVZhbHVlID0gdGhpcy5tYWluLmFkZGFibGUoaW5wdXRWYWx1ZSlcbiAgICAvLyAgIGxldCBhZGRhYmxlVmFsdWVTdHIgPSAnJ1xuICAgIC8vICAgaWYgKCFhZGRhYmxlVmFsdWUpIHtcbiAgICAvLyAgICAgcmV0dXJuXG4gICAgLy8gICB9XG4gICAgLy9cbiAgICAvLyAgIGlmICh0eXBlb2YgYWRkYWJsZVZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgIC8vICAgICBjb25zdCB2YWxpZFZhbHVlID0gdmFsaWRhdGVPcHRpb24oYWRkYWJsZVZhbHVlKVxuICAgIC8vICAgICBpZiAodmFsaWRWYWx1ZSkge1xuICAgIC8vICAgICAgIHRoaXMubWFpbi5hZGREYXRhKGFkZGFibGVWYWx1ZSlcbiAgICAvLyAgICAgICBhZGRhYmxlVmFsdWVTdHIgPSAoYWRkYWJsZVZhbHVlLnZhbHVlID8gYWRkYWJsZVZhbHVlLnZhbHVlIDogYWRkYWJsZVZhbHVlLnRleHQpXG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH0gZWxzZSB7XG4gICAgLy8gICAgIHRoaXMubWFpbi5hZGREYXRhKHRoaXMubWFpbi5kYXRhLm5ld09wdGlvbih7XG4gICAgLy8gICAgICAgdGV4dDogYWRkYWJsZVZhbHVlLFxuICAgIC8vICAgICAgIHZhbHVlOiBhZGRhYmxlVmFsdWVcbiAgICAvLyAgICAgfSkpXG4gICAgLy8gICAgIGFkZGFibGVWYWx1ZVN0ciA9IGFkZGFibGVWYWx1ZVxuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICB0aGlzLm1haW4uc2VhcmNoKCcnKVxuICAgIC8vICAgc2V0VGltZW91dCgoKSA9PiB7IC8vIFRlbXAgZml4IHRvIHNvbHZlIG11bHRpIHJlbmRlciBpc3N1ZVxuICAgIC8vICAgICB0aGlzLm1haW4uc2V0KGFkZGFibGVWYWx1ZVN0ciwgJ3ZhbHVlJywgZmFsc2UsIGZhbHNlKVxuICAgIC8vICAgfSwgMTAwKVxuICAgIC8vXG4gICAgLy8gICAvLyBDbG9zZSBpdCBvbmx5IGlmIGNsb3NlT25TZWxlY3QgPSB0cnVlXG4gICAgLy8gICBpZiAodGhpcy5tYWluLmNvbmZpZy5jbG9zZU9uU2VsZWN0KSB7XG4gICAgLy8gICAgIHNldFRpbWVvdXQoKCkgPT4geyAvLyBHaXZlIGl0IGEgbGl0dGxlIHBhZGRpbmcgZm9yIGEgYmV0dGVyIGxvb2tpbmcgYW5pbWF0aW9uXG4gICAgLy8gICAgICAgdGhpcy5tYWluLmNsb3NlKClcbiAgICAvLyAgICAgfSwgMTAwKVxuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICAvLyBjb250YWluZXIuYXBwZW5kQ2hpbGQoYWRkYWJsZSlcbiAgICAvL1xuICAgIC8vIHNlYXJjaFJldHVybi5hZGRhYmxlID0gYWRkYWJsZVxuICAgIFxuICAgIHJldHVybiBzZWFyY2hSZXR1cm47XG4gIH1cbiAgXG4gICNsaXN0RGl2KCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBsaXN0LmNsYXNzTGlzdC5hZGQoJ3NzLWxpc3QnKVxuICAgIGxpc3Quc2V0QXR0cmlidXRlKCdyb2xlJywgJ2xpc3Rib3gnKVxuICAgIHJldHVybiBsaXN0XG4gIH1cbiAgXG4gIHB1YmxpYyBzaW5nbGVTZWxlY3RlZERpdigpOiBTaW5nbGVTZWxlY3RlZCB7XG4gICAgY29uc3QgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLXNpbmdsZS1zZWxlY3RlZCcpXG4gICAgXG4gICAgLy8gUGxhY2Vob2xkZXIgdGV4dFxuICAgIGNvbnN0IHBsYWNlaG9sZGVyOiBIVE1MU3BhbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBwbGFjZWhvbGRlci5jbGFzc0xpc3QuYWRkKCdwbGFjZWhvbGRlcicpXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBsYWNlaG9sZGVyKVxuICAgIFxuICAgIC8vIERlc2VsZWN0XG4gICAgY29uc3QgZGVzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBkZXNlbGVjdC5pbm5lckhUTUwgPSBcInhcIlxuICAgIGRlc2VsZWN0LmNsYXNzTGlzdC5hZGQoJ3NzLWRlc2VsZWN0JywgJ3NzLWhpZGUnKVxuICAgIGRlc2VsZWN0Lm9uY2xpY2sgPSB0aGlzLm9uRGVzZWxlY3Q7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRlc2VsZWN0KVxuICAgIFxuICAgIC8vIEFycm93XG4gICAgY29uc3QgYXJyb3dDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIGFycm93Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NzLWFycm93JylcbiAgICBcbiAgICBjb25zdCBhcnJvd0ljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBhcnJvd0ljb24uY2xhc3NMaXN0LmFkZCgnYXJyb3ctZG93bicpXG4gICAgYXJyb3dDb250YWluZXIuYXBwZW5kQ2hpbGQoYXJyb3dJY29uKVxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChhcnJvd0NvbnRhaW5lcilcbiAgICBcbiAgICAvLyBBZGQgb25jbGljayBmb3IgbWFpbiBzZWxlY3RvciBkaXZcbiAgICBjb250YWluZXIub25jbGljayA9ICgpID0+IHtcbiAgICAgIHRoaXMuaXNPcGVuZWQgPyB0aGlzLm9uQ2xvc2UoKSA6IHRoaXMub25PcGVuKCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBjb250YWluZXIsXG4gICAgICBwbGFjZWhvbGRlcixcbiAgICAgIGRlc2VsZWN0LFxuICAgICAgYXJyb3dJY29uOiB7XG4gICAgICAgIGNvbnRhaW5lcjogYXJyb3dDb250YWluZXIsXG4gICAgICAgIGFycm93OiBhcnJvd0ljb25cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iLCJpbXBvcnQgeyBPcHRpb259IGZyb20gXCIuL21vZGVsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RQYXJzZXIge1xuICBwdWJsaWMgZWw6IEhUTUxTZWxlY3RFbGVtZW50O1xuICBcbiAgY29uc3RydWN0b3IoZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgaWYgKCEoZWwgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigndGhpbi1zZWxlY3Q6IFwic2VsZWN0XCIgZG9tIGVsZW1lbnQgbXVzdCBiZSBhbiBIVE1MU2VsZWN0RWxlbWVudCcpO1xuICAgIH1cbiAgICB0aGlzLmVsID0gZWw7XG4gIH1cbiAgXG4gIGFuYWx5emUoKSB7XG4gICAgY29uc3QgaXNNdWx0aXBsZSA9IHRoaXMuZWwubXVsdGlwbGU7XG4gICAgY29uc3Qgb3B0aW9uczogT3B0aW9uW10gPSBbXTtcbiAgXG4gICAgQXJyYXkuZnJvbSh0aGlzLmVsLm9wdGlvbnMpLmZvckVhY2goKG9wdGlvbjogSFRNTE9wdGlvbkVsZW1lbnQpID0+IHtcbiAgICAgIG9wdGlvbnMucHVzaCh7IHZhbHVlOiBvcHRpb24udmFsdWUsIHRleHQ6IG9wdGlvbi50ZXh0LCBzZWxlY3RlZDogb3B0aW9uLnNlbGVjdGVkIH0pO1xuICAgIH0pO1xuICBcbiAgICByZXR1cm4oe1xuICAgICAgaXNNdWx0aXBsZSxcbiAgICAgIG9wdGlvbnNcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi4vc3R5bGVzL3RoaW4tc2VsZWN0LnNjc3NcIlxuaW1wb3J0IERvbUJ1aWxkZXIgZnJvbSBcIi4vZG9tX2J1aWxkZXJcIjtcbmltcG9ydCBTZWxlY3RQYXJzZXIgZnJvbSBcIi4vc2VsZWN0X3BhcnNlclwiO1xuaW1wb3J0IHtPcHRpb259IGZyb20gXCIuL21vZGVsc1wiXG5cbmludGVyZmFjZSBUaGluU2VsZWN0UGFyYW1zIHtcbiAgc2VsZWN0OiBzdHJpbmcgfCBIVE1MU2VsZWN0RWxlbWVudDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGhpblNlbGVjdCB7XG4gIHB1YmxpYyBidWlsZGVyOiBEb21CdWlsZGVyO1xuICBwdWJsaWMgaWQ6IHN0cmluZztcbiAgcHVibGljIGRpc3BsYXllZE9wdGlvbnNMaXN0OiBPcHRpb25bXTtcbiAgcHVibGljIGlzU2VhcmNoaW5nOiBib29sZWFuO1xuICBcbiAgY29uc3RydWN0b3IocGFyYW1zOiBUaGluU2VsZWN0UGFyYW1zKSB7XG4gICAgY29uc3QgZWw6IEhUTUxTZWxlY3RFbGVtZW50ID0gdHlwZW9mIChwYXJhbXMuc2VsZWN0KSA9PT0gXCJzdHJpbmdcIiA/IChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhcmFtcy5zZWxlY3QpIGFzIEhUTUxTZWxlY3RFbGVtZW50KSA6IHBhcmFtcy5zZWxlY3Q7XG4gICAgXG4gICAgY29uc3QgaW5pdGlhbFNlbGVjdEluZm8gPSAobmV3IFNlbGVjdFBhcnNlcihlbCkpLmFuYWx5emUoKTtcbiAgICBcbiAgICB0aGlzLmlkID0gJ3RzLScgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDApO1xuICAgIHRoaXMuaXNTZWFyY2hpbmcgPSBmYWxzZTtcbiAgICBcbiAgICB0aGlzLmJ1aWxkZXIgPSBuZXcgRG9tQnVpbGRlcihcbiAgICAgICAgZWwsXG4gICAgICAgIHRoaXMuaWQsXG4gICAgICAgIGluaXRpYWxTZWxlY3RJbmZvLmlzTXVsdGlwbGUsXG4gICAgICAgIHRoaXMub25TZWFyY2gsXG4gICAgICAgIHRoaXMub25PcHRpb25TZWxlY3QsXG4gICAgICAgIHRoaXMub25EZXNlbGVjdCxcbiAgICAgICAgdGhpcy5jbG9zZVBhbmVsLFxuICAgICAgICB0aGlzLm9wZW5QYW5lbCxcbiAgICApO1xuICAgIHRoaXMuZGlzcGxheWVkT3B0aW9uc0xpc3QgPSBpbml0aWFsU2VsZWN0SW5mby5vcHRpb25zO1xuICAgIHRoaXMuYnVpbGRlci5zZXREaXNwbGF5TGlzdCh0aGlzLmRpc3BsYXllZE9wdGlvbnNMaXN0KTtcbiAgfVxuICBcbiAgb25TZWFyY2ggPSAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgdGhpcy5pc1NlYXJjaGluZyA9IHRydWU7XG4gICAgY29uc3QgbWF0Y2hlZE9wdGlvbnMgPSB0aGlzLmRpc3BsYXllZE9wdGlvbnNMaXN0LmZpbHRlcihvcHRpb24gPT4gdGhpcy5zZWFyY2hGaWx0ZXIob3B0aW9uLnRleHQsIHRleHQpKTtcbiAgICB0aGlzLmJ1aWxkZXIuc2V0RGlzcGxheUxpc3QobWF0Y2hlZE9wdGlvbnMpO1xuICB9XG4gIFxuICBvbkRlc2VsZWN0ID0gKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBvbkRlc2VsZWN0YClcbiAgfVxuICBcbiAgY2xvc2VQYW5lbCA9ICgpID0+IHtcbiAgICB0aGlzLmJ1aWxkZXIuY2xvc2VQYW5lbCgpO1xuICAgIFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5idWlsZGVyLnNldERpc3BsYXlMaXN0KHRoaXMuZGlzcGxheWVkT3B0aW9uc0xpc3QpO1xuICAgIH0sIDEwMCk7XG4gICAgdGhpcy5pc1NlYXJjaGluZyA9IGZhbHNlO1xuICB9XG4gIFxuICBvcGVuUGFuZWwgPSAoKSA9PiB7XG4gICAgdGhpcy5idWlsZGVyLm9wZW5QYW5lbCgpO1xuICB9XG4gIFxuICBvbk9wdGlvblNlbGVjdCA9IChvcHRpb246IE9wdGlvbikgPT4ge1xuICAgIHRoaXMuZGlzcGxheWVkT3B0aW9uc0xpc3QuZm9yRWFjaCgoeCkgPT4ge1xuICAgICAgaWYgKHgudmFsdWUgPT09IG9wdGlvbi52YWx1ZSkge1xuICAgICAgICB4LnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHguc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KVxuICAgIHRoaXMuYnVpbGRlci5zZXRTZWxlY3RlZChvcHRpb24pO1xuICAgIHRoaXMuY2xvc2VQYW5lbCgpO1xuICB9XG4gIFxuICBzZWFyY2hGaWx0ZXIgPSAob3B0aW9uVGV4dDogc3RyaW5nLCBpbnB1dFRleHQ6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBvcHRpb25UZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihpbnB1dFRleHQudG9Mb3dlckNhc2UoKSkgIT09IC0xO1xuICB9XG4gIFxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW1CYyxNQUFPLFVBQVUsQ0FBQTtBQUN0QixJQUFBLFNBQVMsQ0FBZ0I7QUFDekIsSUFBQSxPQUFPLENBQWdCO0FBQ3ZCLElBQUEsTUFBTSxDQUFRO0FBQ2QsSUFBQSxJQUFJLENBQWdCO0FBQ3BCLElBQUEsY0FBYyxDQUF1QjtBQUdyQyxJQUFBLFFBQVEsQ0FBSztBQUNiLElBQUEsVUFBVSxDQUFLO0FBQ2YsSUFBQSxPQUFPLENBQUs7QUFDWixJQUFBLE1BQU0sQ0FBSztBQUNYLElBQUEsY0FBYyxDQUFLO0FBQ25CLElBQUEsVUFBVSxDQUFTO0FBQ25CLElBQUEsUUFBUSxDQUFTO0FBRWpCLElBQUEsT0FBTyxDQUFvQjtBQUVsQyxJQUFBLFdBQUEsQ0FDSSxFQUFxQixFQUNyQixFQUFVLEVBQ1YsVUFBbUIsRUFDbkIsUUFBYSxFQUNiLGNBQW1CLEVBQ25CLFVBQWUsRUFDZixPQUFZLEVBQ1osTUFBVyxFQUFBO0FBRWIsUUFBQSxJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztBQUNsQixRQUFBLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0FBQ3pCLFFBQUEsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7QUFDN0IsUUFBQSxJQUFJLENBQUMsY0FBYyxHQUFHLGNBQWMsQ0FBQztBQUNyQyxRQUFBLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0FBQ3ZCLFFBQUEsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFFckIsUUFBQSxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztBQUM3QixRQUFBLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FB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
